<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>vscode中的MatLab环境 - 鸽园</title><meta name="description" content="Motivation 以后或许要用到MatLab，先配个环境。习惯了vscode，什么都想看看能不能用vsc来做。 Licensed MatLab Python 这里要注意，不同的MatLab版本支持的Python version有所不同。我现在主要是以py310为target，前向兼容一般做到py37。而MatLab R2022b最高只支持py39，最新的支持py37的MatLab版本是R2021b。 这里有一篇外文博客，有不详细的地方可以到这里查阅 cd ${MATLAB_ROOT}/extern/engines/python #&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://zzsblog.top/run-matlab-in-vscode-jupyter.html"><link rel="amphtml" href="https://zzsblog.top/amp/run-matlab-in-vscode-jupyter.html"><link rel="alternate" type="application/atom+xml" href="https://zzsblog.top/feed.xml"><link rel="alternate" type="application/json" href="https://zzsblog.top/feed.json"><meta property="og:title" content="vscode中的MatLab环境"><meta property="og:image" content="https://zzsblog.top/media/posts/9/download1"><meta property="og:site_name" content="鸽园"><meta property="og:description" content="Motivation 以后或许要用到MatLab，先配个环境。习惯了vscode，什么都想看看能不能用vsc来做。 Licensed MatLab Python 这里要注意，不同的MatLab版本支持的Python version有所不同。我现在主要是以py310为target，前向兼容一般做到py37。而MatLab R2022b最高只支持py39，最新的支持py37的MatLab版本是R2021b。 这里有一篇外文博客，有不详细的地方可以到这里查阅 cd ${MATLAB_ROOT}/extern/engines/python #&hellip;"><meta property="og:url" content="https://zzsblog.top/run-matlab-in-vscode-jupyter.html"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://zzsblog.top/media/website/favicon.png" type="image/png"><link rel="stylesheet" href="https://zzsblog.top/assets/css/style.css?v=ebde456a0982dc3b4cf9161f1fc0c160"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://zzsblog.top/run-matlab-in-vscode-jupyter.html"},"headline":"vscode中的MatLab环境","datePublished":"2022-08-26T15:38","dateModified":"2022-08-26T15:38","image":{"@type":"ImageObject","url":"https://zzsblog.top/media/posts/9/download1","height":false,"width":false},"description":"Motivation 以后或许要用到MatLab，先配个环境。习惯了vscode，什么都想看看能不能用vsc来做。 Licensed MatLab Python 这里要注意，不同的MatLab版本支持的Python version有所不同。我现在主要是以py310为target，前向兼容一般做到py37。而MatLab R2022b最高只支持py39，最新的支持py37的MatLab版本是R2021b。 这里有一篇外文博客，有不详细的地方可以到这里查阅 cd ${MATLAB_ROOT}/extern/engines/python #&hellip;","author":{"@type":"Person","name":"JamzumSum","url":"https://zzsblog.top/author/jamzumsum/"},"publisher":{"@type":"Organization","name":"JamzumSum","logo":{"@type":"ImageObject","url":"https://zzsblog.top/media/website/favicon-2.png","height":480,"width":480}}}</script><script>window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      processEscapes: true,
    }
  }</script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><link href="https://cdn.jsdelivr.net/npm/prismjs@v1.x/themes/prism.css" rel="stylesheet"></head><body><script src="https://cdn.jsdelivr.net/npm/prismjs@v1.x/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@v1.x/plugins/autoloader/prism-autoloader.min.js"></script><div class="container"><header class="header" id="js-header"><a href="https://zzsblog.top/" class="logo"><img src="https://zzsblog.top/media/website/favicon-2.png" alt="鸽园" width="480" height="480"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://zzsblog.top/" title="Goto Homepage" target="_self">Home</a></li><li class="has-submenu"><a href="https://zzsblog.top/tag/" title="Categories" target="_self" aria-haspopup="true">Categories</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://zzsblog.top/tag/coding/" title="Coding" target="_self">Coding</a></li><li><a href="https://zzsblog.top/tag/qzone2tg/" title="Collections of Qzone2TG posts" target="_self">Qzone2TG</a></li></ul></li><li><a href="https://zzsblog.top/about.html" title="About me">About</a></li><li><a href="https://github.com/JamzumSum/zzsblog" title="Goto blog repo on GitHub" target="_blank">GitHub</a></li><li><a href="https://zzsblog.top/merger.html" title="Buy me a cup of coffee☕" target="_self">Donate</a></li></ul></nav></header><main><article class="post wrapper"><header class="hero"><p class="post__meta">Published on <time datetime="2022-08-26T15:38">22/08/26</time></p><h1 class="post__title">vscode中的MatLab环境</h1></header><figure class="post__featured-image post__image--wide"><img src="https://zzsblog.top/media/posts/9/download1" loading="eager" height="1280" width="1920" alt=""><figcaption>math @dancristianpaduret</figcaption></figure><div class="post__entry"><h2 id="motivation">Motivation</h2><p>以后或许要用到MatLab，先配个环境。习惯了vscode，什么都想看看能不能用vsc来做。</p><h2 id="preparation">Preparation</h2><ul><li><p>Licensed MatLab</p></li><li><p>Python</p><p>这里要注意，不同的MatLab版本支持的Python version有所不同。我现在主要是以py310为target，前向兼容一般做到py37。而MatLab <code>R2022b</code>最高只支持py39，最新的支持py37的MatLab版本是<code>R2021b</code>。</p></li></ul><h2 id="matlab-in-jupyterlab">MatLab in JupyterLab</h2><blockquote><p>这里有一篇<a href="http://www.jmlilly.net/jupyter-matlab">外文博客</a>，有不详细的地方可以到这里查阅</p></blockquote><ol start="0"><li>创建、激活环境</li><li>安装pip包<a href="https://github.com/Calysto/matlab_kernel">matlab kernel</a>以及<code>jupyter</code>, <code>jupyterlab</code>, <code>ipykernel</code>：<code>pip install matlab_kernel jupyter jupyterlab ipykernel</code></li><li>安装jupyter内核：<code>python -m matlab_kernel install</code></li><li>仍然在当前的环境里，安装<a href="https://ww2.mathworks.cn/help/matlab/matlab_external/install-the-matlab-engine-for-python.html">MatLab Python Engine</a>:</li></ol><pre><code class="language-sh">cd ${MATLAB_ROOT}/extern/engines/python    # ${MATLAB_ROOT}是MatLab的安装目录
python setup.py install
</code></pre><p>检查：<code>jupyter kernelspec list</code>，若能列出 matlab 内核就可以了。</p><p>此时您已经可以在此环境的jupyter notebook, jupyterlab中使用 matlab 语法并运行了。</p><h2 id="matlab-in-vscode">MatLab in vscode</h2><p>语法检查与高亮：插件<a href="https://github.com/Gimly/vscode-matlab">Gimly81.matlab</a>。需要配置<code>mlint</code>路径，才能开始语法检查。</p><p>上文已经可以在jupyter notebook里运行 MatLab了。众所周知，vsc是支持 jupyter notebook的。不过我们之前的一系列操作都是在特定的环境里面操作的，而 vsc里选择matlab内核时并没有附带在哪个环境运行的选项。下面稍微修改一下之前安装的 jupyter 内核，使得它能够在 vscode 里正常运行。</p><p>之前运行<code>python -m matlab_kernel install</code>的时候，输出会打出<code>kernel.json</code>的存储位置，如<code>C:\ProgramData\jupyter\kernels\matlab\kernel.json</code>。打开发现是这样的结构：</p><pre><code class="language-json">{
    &quot;argv&quot;: [
        &quot;python&quot;,
        &quot;-m&quot;,
        &quot;matlab_kernel&quot;,
        &quot;-f&quot;,
        &quot;{connection_file}&quot;
    ],
    &quot;display_name&quot;: &quot;Matlab&quot;,
    &quot;language&quot;: &quot;matlab&quot;,
    &quot;mimetype&quot;: &quot;text/x-octave&quot;,
    &quot;name&quot;: &quot;matlab_connect&quot;
}
</code></pre><p>可以看到雀实没有指定环境。查阅 jupyter client的<a href="https://jupyter-client.readthedocs.io/en/stable/kernels.html#kernel-specs">文档</a>，发现可以指定内核的环境变量，从而实现指定 python 环境：</p><pre><code class="language-json">&quot;env&quot;: {
    &quot;VIRTUAL_ENV&quot;: &quot;${KERNEL_VENV}&quot;,
    &quot;PATH&quot;: &quot;${KERNEL_VENV}\\Scripts;${PATH}&quot;
}
</code></pre><p>我们可以在配置中加入这样的字段，从而让 vscode 的 jupyter client能够找到运行 <code>matlab_kernel</code> 的环境。<code>${KERNEL_VENV}</code> 是之前的虚拟环境的路径。上述写法用于windows，linux的分隔符是冒号而不是分号，子目录应该也不是Scripts（而是bin？）</p><p>改完之后在 vscode 的 jupyter notebook 里就可以启动 MatLab 内核了。</p><h2 id="后记">后记</h2><p>运行可以用测试任务解决，但调试目前还没找到在vsc内部实现的办法。调用 MatLab调试参考<a href="https://stackoverflow.com/a/44584908">如下回答</a></p></div><footer class="post__footer"><div class="post__footer__col"><ul class="post__tag"><li><a href="https://zzsblog.top/tag/coding/">Coding</a></li><li><a href="https://zzsblog.top/tag/matlab/">MatLab</a></li></ul><div class="post__share"></div></div><nav class="post__nav"><div class="post__nav__prev">Previous Post<h5><a href="https://zzsblog.top/edit-exif-header.html" class="inverse" rel="prev">如何修改图像的 EXIF 头信息？</a></h5></div></nav></footer></article></main><footer class="footer"><div class="footer__copyright">Powered by Publii</div></footer></div><script defer="defer" src="https://zzsblog.top/assets/js/scripts.min.js?v=620157e86bfc246cfef480b1b4aadb48"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.navbar'};</script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>